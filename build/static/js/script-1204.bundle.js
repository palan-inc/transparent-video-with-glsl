!function(){"use strict";var t,e,i,r,n,o,a,l,s,g,u,c,h,f=function(){function t(){this.classNameActive="is-active"}return t.prototype.activateDOM=function(t){t.classList.add(this.classNameActive)},t.prototype.deactivateDOM=function(t){t.classList.remove(this.classNameActive)},t}(),E=function(){function t(){this.gl=null}return t.prototype.initWebGLContext=function(t){this.gl=t.getContext("webgl")},t.prototype.getWebGLContext=function(){return this.gl},t.prototype.initTexture=function(){var t=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,t);var e=this.gl.RGBA,i=this.gl.RGBA,r=this.gl.UNSIGNED_BYTE,n=new Uint8Array([0,0,0,255]);return this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.texImage2D(this.gl.TEXTURE_2D,0,e,1,1,0,i,r,n),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),t},t.prototype.updateTexture=function(t,e){var i=this.gl.RGBA,r=this.gl.RGBA,n=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texImage2D(this.gl.TEXTURE_2D,0,i,r,n,e)},t.prototype.createShader=function(t,e){var i;switch(t){case"vertex":i=this.gl.createShader(this.gl.VERTEX_SHADER);break;case"fragment":i=this.gl.createShader(this.gl.FRAGMENT_SHADER);break;default:return}if(this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))return i;alert(this.gl.getShaderInfoLog(i)),console.log(this.gl.getShaderInfoLog(i))},t.prototype.createProgram=function(t,e){var i=this.gl.createProgram();return this.gl.attachShader(i,t),this.gl.attachShader(i,e),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.gl.useProgram(i),i):null},t.prototype.createVbo=function(t){var e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),e},t.prototype.createIbo=function(t){var e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Int16Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),e},t}(),d=E,m=0,T=new Array,R=!1;function v(t){a=t.offsetX/n,l=t.offsetY/o}function A(){c&&(m=.001*((new Date).getTime()-i),R&&e.updateTexture(g,u),s.clear(s.COLOR_BUFFER_BIT),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,g),s.uniform1f(T[0],m+0),s.uniform2fv(T[1],[a,l]),s.uniform2fv(T[2],[n,o]),s.uniform1i(T[3],0),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),s.flush(),setTimeout(A,33.333333333333336))}t=new f,e=new d,window.onload=function(){u=function(t){var e=document.createElement("video"),i=!1,r=!1;function n(){i&&r&&(R=!0)}return e.autoplay=!0,e.muted=!0,e.loop=!0,e.setAttribute("preload","auto"),e.setAttribute("playsinline",""),e.setAttribute("webkit-playsinline",""),e.addEventListener("playing",(function(){i=!0,n()}),!0),e.addEventListener("timeupdate",(function(){r=!0,n()}),!0),e.src="../static/video/video-1204.mp4",e.play(),e}(),h=document.getElementById("ui"),document.getElementById("ui_button").addEventListener("click",(function(){u.pause(),u.muted=!1,u.currentTime=0,u.play(),t.deactivateDOM(h),t.activateDOM(r)})),r=document.getElementById("canvas"),n=1280,o=720,r.width=n,r.height=o,r.addEventListener("mousemove",v,!0),e.initWebGLContext(r),s=e.getWebGLContext();var f=e.createProgram(e.createShader("vertex","\n  attribute vec3 position;\n  void main(void){\n    gl_Position = vec4(position, 1.0);\n  }\n"),e.createShader("fragment","\n  precision mediump float;\n  uniform float time;\n  uniform vec2  mouse;\n  uniform vec2  resolution;\n  uniform sampler2D map;\n  const vec3 chromaKeyColor = vec3(0.0, 1.0, 0.0);\n  const float threshold = 0.785;\n  void main(void) {\n    vec2 uv = gl_FragCoord.xy / resolution.xy;\n    vec3 textureColor = texture2D(map, uv).rgb;\n    float difference = length(chromaKeyColor - textureColor.rgb);\n    gl_FragColor = difference < threshold ? vec4(0.0, 0.0, 0.0, 0.0) : vec4(textureColor, 1.0);\n  }\n"));c=null!=f,T[0]=s.getUniformLocation(f,"time"),T[1]=s.getUniformLocation(f,"mouse"),T[2]=s.getUniformLocation(f,"resolution"),T[3]=s.getUniformLocation(f,"map");var E=e.createVbo([-1,1,0,1,1,0,-1,-1,0,1,-1,0]),d=e.createIbo([0,2,1,1,2,3]),m=s.getAttribLocation(f,"position");s.bindBuffer(s.ARRAY_BUFFER,E),s.enableVertexAttribArray(m),s.vertexAttribPointer(m,3,s.FLOAT,!1,0,0),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,d),s.clearColor(0,0,0,1),a=.5,l=.5,i=(new Date).getTime(),g=e.initTexture(),A()},window.addEventListener("pageshow",(function(t){t.persisted&&location.reload()}))}();